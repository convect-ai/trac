"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[995],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),u=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,f=m["".concat(p,".").concat(d)]||m[d]||s[d]||o;return n?a.createElement(f,l(l({ref:t},c),{},{components:n})):a.createElement(f,l({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8295:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>s,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var a=n(7462),r=(n(7294),n(3905));const o={title:"Build an application image"},l="Build an application image",i={unversionedId:"tutorial-vrp/build-image",id:"tutorial-vrp/build-image",title:"Build an application image",description:"Declare the input/output of your solution",source:"@site/docs/tutorial-vrp/02-build-image.md",sourceDirName:"tutorial-vrp",slug:"/tutorial-vrp/build-image",permalink:"/trac/docs/tutorial-vrp/build-image",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Build an application image"},sidebar:"tutorialSidebar",previous:{title:"Develop the solution locally",permalink:"/trac/docs/tutorial-vrp/develop-locally"},next:{title:"Publish the application",permalink:"/trac/docs/tutorial-vrp/publish-app"}},p={},u=[{value:"Declare the input/output of your solution",id:"declare-the-inputoutput-of-your-solution",level:2},{value:"Declare the parameter of your solution",id:"declare-the-parameter-of-your-solution",level:2},{value:"Declare the exposed functions of your solution",id:"declare-the-exposed-functions-of-your-solution",level:2},{value:"Build the image",id:"build-the-image",level:2}],c={toc:u};function s(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"build-an-application-image"},"Build an application image"),(0,r.kt)("h2",{id:"declare-the-inputoutput-of-your-solution"},"Declare the input/output of your solution"),(0,r.kt)("p",null,"After the scripts can run without any problem locally, then one need to define the inputs and outputs formats the scripts take in and generate.\nTRAC will use this information to automatically render a UI and API suite for your application."),(0,r.kt)("p",null,"For example, let's assume your script takes in a file in the following format"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"location"),(0,r.kt)("th",{parentName:"tr",align:null},"x_cord"),(0,r.kt)("th",{parentName:"tr",align:null},"y_cord"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location-0"),(0,r.kt)("td",{parentName:"tr",align:null},"456"),(0,r.kt)("td",{parentName:"tr",align:null},"320")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location-1"),(0,r.kt)("td",{parentName:"tr",align:null},"228"),(0,r.kt)("td",{parentName:"tr",align:null},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location-2"),(0,r.kt)("td",{parentName:"tr",align:null},"912"),(0,r.kt)("td",{parentName:"tr",align:null},"0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location-3"),(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},"80")))),(0,r.kt)("p",null,"Then you can define the format for the file as"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "name": "locations",\n    "mount_path": "data/locations.csv",\n    "type": "input",\n    "description": "Locations to visit",\n    "file_schema": {\n        "type": "object",\n        "properties": {\n            "location": {\n                "type": "string",\n                "description": "Location name"\n            },\n            "x_cord": {\n                "type": "number",\n                "description": "X coordinate"\n            },\n            "y_cord": {\n                "type": "number",\n                "description": "Y coordinate"\n            }\n        }\n    }\n}\n')),(0,r.kt)("h2",{id:"declare-the-parameter-of-your-solution"},"Declare the parameter of your solution"),(0,r.kt)("p",null,"Parameters control the behavior of your scripts. For example, in a machine learning model, parameters can be the learning rate of the model.\nTo define a parameter your app can accept, use the following format"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "parameter": {\n        "mount_path": "data/parameters.json",\n        "parameters": [\n            {\n                "name": "num_vehicles",\n                "type": "integer",\n                "description": "Number of vehicles in the fleet",\n                "default": 4\n            },\n            {\n                "name": "depot",\n                "type": "integer",\n                "description": "Depot location",\n                "default": 0\n            }\n        ]\n    }\n}\n')),(0,r.kt)("p",null,"In the above example, we define two integer type parameters."),(0,r.kt)("h2",{id:"declare-the-exposed-functions-of-your-solution"},"Declare the exposed functions of your solution"),(0,r.kt)("p",null,"The last step is to define the entry point to your scripts -- what function to trigger when your main logic is invoked."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "handler": {\n        "handler": "vrp_demo_script.main:main"\n    }\n}\n')),(0,r.kt)("p",null,"The above defines the entry point as the ",(0,r.kt)("inlineCode",{parentName:"p"},"main")," function under ",(0,r.kt)("inlineCode",{parentName:"p"},"vrp_demo_script.main")," module."),(0,r.kt)("p",null,"This is a full example of ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/convect-ai/trac/blob/master/examples/vrp-demo-script/trac.json"},(0,r.kt)("inlineCode",{parentName:"a"},"trac.json")),"."),(0,r.kt)("h2",{id:"build-the-image"},"Build the image"),(0,r.kt)("p",null,"You can trigger the building process by"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"trac-cli build examples/vrp-demo-script/ --image-name vrp-algo\n")),(0,r.kt)("p",null,"This will build a docker image named ",(0,r.kt)("inlineCode",{parentName:"p"},"vrp-algo"),".\nYou can verify if the image will successfully run by"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run --rm vrp-algo -- spec\n")),(0,r.kt)("p",null,"This will print out the contents of the ",(0,r.kt)("inlineCode",{parentName:"p"},"trac.json")," defined earlier."))}s.isMDXComponent=!0}}]);